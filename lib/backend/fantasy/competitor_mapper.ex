defmodule Backend.Fantasy.MTCompetitorMapper do
  @moduledoc """
  Maps names for masters tour fantasy competitions
  usually using the spreadseets that map names
  """

  import Ecto.Query, warn: false
  alias Backend.Repo
  alias Ecto.Multi
  alias Backend.Fantasy.LeagueTeamPick

  def map_existing(mt = :Dalaran) do
    string_mt = to_string(mt)

    get(mt)
    |> Enum.filter(fn {k, v} -> k != v end)
    |> Enum.each(fn {old, new} ->
      query =
        from ltp in LeagueTeamPick,
          join: lt in assoc(ltp, :team),
          join: l in assoc(lt, :league),
          where:
            ltp.pick == ^old and l.competition_type == "masters_tour" and
              l.competition == ^string_mt

      Backend.Repo.update_all(query, set: [pick: new])
    end)
  end

  def map(player, "Dalaran") do
    get(:Dalaran)
    |> Map.get(player, player)
  end

  def map(player, _), do: player

  defp get(:Dalaran) do
    %{
      "Ace103#1126" => "Ace103#1126",
      "Ackerman#1857" => "Ackerman#1857",
      "ADU#3438" => "ADU#3438",
      "AiurCreeper#5511" => "AiurCreeper#11503",
      "AjjXiGuan#5914" => "AjjXiGuan#1144",
      "Alan870806#1754" => "Alan870806#1754",
      "AllBor#21183" => "AllBor#21183",
      "Allen#32753" => "Allen#32753",
      "Alo#22800" => "Alo#22800",
      "Alpe#31184" => "Alpe#31184",
      "Alutemu#1172" => "Alutemu#1172",
      "Apollion#2935" => "Apollion#2935",
      "Aquaman575#1633" => "Aquaman575#1633",
      "Arctic#21513" => "Arctic#21513",
      "Athanas#1830" => "Athanas#1830",
      "AyRoK#2374" => "AyRoK#2374",
      "BabyBear#21485" => "BabyBear#21485",
      "BadBoy#2512" => "BadBoy#2512",
      "Bankyugi#1988" => "Bankyugi#1988",
      "batupaksoy#2436" => "batupaksoy#2436",
      "Bequiet#2179" => "Bequiet#2179",
      "blitzchung#3549" => "blitzchung#3549",
      "Blowns#1770" => "Blowns#1770",
      "Bozzzton#2511" => "Bozzzton#2511",
      "BPM#31975" => "BPM#31975",
      "Briarthorn#11350" => "Briarthorn#11350",
      "Bullets#21122" => "Bullets#21122",
      "Bunnyhoppor#2897" => "Bunnyhoppor#2897",
      "Butterz#1127" => "Butterz#1127",
      "CaelesLuna#1906" => "CaelesLuna#1906",
      "cagnetta99#2575" => "cagnetta99#2575",
      "calisolo#3428" => "calisolo#3428",
      "Casie#2884" => "Casie#2884",
      "ChaboDennis#2598" => "ChaboDennis#2598",
      "Che0nsu#3470" => "Che0nsu#3470",
      "CheeseHead#2178" => "CheeseHead#2178",
      "Chemagician#1676" => "Chemagician#1676",
      "choncho#11106" => "choncho#11106",
      "Cikos#21544" => "Cikos#21544",
      "Dardarbinks#11359" => "Dardarbinks#11359",
      "DavidSWu#1595" => "DavidSWu#1595",
      "dawido#2832" => "dawido#2832",
      "DawN#3542" => "DawN#3542",
      "DawnSuSu#5256" => "DawnSuSu#1385",
      "Dayn#1715" => "Dayn#1715",
      "Dcon#11969" => "Dcon#11969",
      "DeadDraw#2311" => "DeadDraw#2311",
      "Definition#31238" => "Definition#31238",
      "deFox#11641" => "deFox#11641",
      "DenBut#1400" => "DenBut#1143",
      "DerBass#2554" => "DerBass#2554",
      "Destructor13#2773" => "Destructor13#2773",
      "DevilMat#21846" => "DevilMat#21846",
      "DimitriKazov#1498" => "DimitriKazov#1498",
      "Disq#2920" => "Disq#2920",
      "Dizdemon#2464" => "Dizdemon#2464",
      "Dono#1634" => "Dono#1634",
      "DragonFist#31942" => "DragonFist#31942",
      "DragonMan#4717" => "DragonMan#4717",
      "DreadEye#11302" => "DreadEye#11302",
      "Dreivo#2948" => "Dreivo#2948",
      "Dumbledore#4809" => "Dumbledore#4809",
      "Eddie#13500" => "Eddie#13500",
      "Ekusas#2691" => "Ekusas#2691",
      "En1gma#21477" => "En1gma#21477",
      "Enrico#1146" => "Enrico#1146",
      "Eric#33289" => "Eric#33289",
      "EzXarT#6135" => "EzXarT#6135",
      "Faeli#2572" => "Faeli#2572",
      "Farath#21676" => "Farath#21676",
      "Fate#1121" => "Fate#1121",
      "Ferno4111#2518" => "Ferno4111#2518",
      "fire#32106" => "fire#32106",
      "FiveKSBoat#5651" => "FiveKSBoat#1909",
      "FiveKSMeng#5788" => "神秘的萌萌噠#4470",
      "Fled#1956" => "Fled#1956",
      "Floki#2706" => "Floki#2706",
      "foghi8#1445" => "foghi8#1445",
      "Fossil04081#1215" => "Fossil04081#1215",
      "Frenetic#2377" => "Frenetic#2377",
      "funashi#1862" => "funashi#1862",
      "Furyhunter#2166" => "Furyhunter#2166",
      "Gaby#22525" => "Gaby#22525",
      "GamerRvg#1410" => "GamerRvg#1410",
      "Gangster#51500" => "Gangster#11716",
      "Gavin#13614" => "Gavin#13614",
      "Genghis#2994" => "Genghis#2994",
      "Germanshep#1853" => "Germanshep#1853",
      "glory#1145" => "glory#1145",
      "Goudhout#2717" => "Goudhout#2717",
      "GREAW253#2793" => "GREAW253#2793",
      "GrJim#21209" => "GrJim#21209",
      "grr#31290" => "grr#31290",
      "gyu#31470" => "gyu#31470",
      "Habugabu#2467" => "Habugabu#2467",
      "Haze#31950" => "Haze#31950",
      "hemlock#3453" => "hemlock#3453",
      "herusia#1374" => "herusia#1374",
      "Hi3#31902" => "Hi3#31902",
      "HiggsBoson#1805" => "HiggsBoson#1805",
      "HiImJoZo#2223" => "HiImJoZo#2223",
      "HKroms#2246" => "HKroms#2246",
      "Hoej#2550" => "Hoej#2550",
      "Holmström#21409" => "Holmström#21409",
      "honbee#3168" => "honbee#3168",
      "HSKeDaiBiao#1597" => "HSKeDaiBiao#1597",
      "Hypnos#21372" => "Hypnos#21372",
      "IdanProK#21626" => "IdanProK#21626",
      "iGSyf#5279" => "iGSyf#1153",
      "iGXc#5537" => "iGXc#5537",
      "iGxiaoyao#5463" => "In progress.",
      "Impact#1923" => "Impact#1923",
      "INER#2925" => "INER#2925",
      "iNS4NE#21840" => "iNS4NE#21840",
      "IrvinG#1619" => "IrvinG#1619",
      "J4YOU#21248" => "J4YOU#21248",
      "Jakattack#1815" => "Jakattack#1815",
      "Jarla#21553" => "Jarla#21553",
      "Jay#12424" => "Jay#12424",
      "JEJBenkoJEA#2497" => "JEJBenkoJEA#2497",
      "Jekpack#2831" => "Jekpack#2831",
      "Jeorg#2191" => "Jeorg#2191",
      "jerry#32707" => "jerry#32707",
      "JFM216#1415" => "JFM216#1415",
      "JheickWeiss#1556" => "JheickWeiss#1556",
      "Joaquin#1259" => "Joaquin#1259",
      "Jobsad#21419" => "Jobsad#21419",
      "JrsConley#5580" => "JrsConley#1965",
      "JrsJokerRing#5875" => "JrsJokerRing#1747",
      "JrsLoveStorm#5369" => "JrsLoveStorm#1626",
      "Juristis#2130" => "Juristis#2130",
      "JustSr#2267" => "JustSr#2267",
      "JuZaZ#2609" => "JuZaZ#2609",
      "k1ngkong#1749" => "k1ngkong#1749",
      "kagome#11139" => "kagome#11139",
      "Kariiwar#2799" => "Kariiwar#2799",
      "Këlthrag#2798" => "Këlthrag#2798",
      "kevin#36106" => "kevin#36106",
      "killinallday#1537" => "killinallday#1537",
      "Kiparang#31539" => "Kiparang#31539",
      "KNMDehua#4497" => "KNMDehua#4497",
      "KrajdaCz#2500" => "KrajdaCz#2500",
      "Kranich#31290" => "Kranich#31290",
      "kuroma#11322" => "kuroma#11322",
      "KyleSal#1166" => "KyleSal#1166",
      "Kyo#12168" => "Kyo#12168",
      "KZGXiaobai#5296" => "KZGXiaobai#1554",
      "KZGXmg#5863" => "KZGXmg#1221",
      "KZGYuYi#5153" => "KZGYuYi#1281",
      "lambogod#3307" => "lambogod#3307",
      "lambyseries#1852" => "lambyseries#1852",
      "LeandroLeal#1841" => "LeandroLeal#1841",
      "Leta#21458" => "Leta#21458",
      "levik#2797" => "levik#2797",
      "LFYueying#5833" => "LFYueying#1579",
      "LFZhoulang#5866" => "LFZhoulang#1996",
      "LGDCaimiao#5221" => "LGDCaimiao#1992",
      "LGDMurphy#5917" => "LGDMurphy#1532",
      "LGDXiaoWang#5274" => "LGDXiaoWang#1402",
      "LLIoKoJIaD#2860" => "LLIoKoJIaD#2860",
      "lnguagehackr#1412" => "lnguagehackr#1412",
      "Locksthene#2594" => "Locksthene#2594",
      "Logoss#21908" => "Logoss#21908",
      "LooGiiQQ#2195" => "LooGiiQQ#2195",
      "LPdestiny#5703" => "LPdestiny#1961",
      "Lucasdmnasc#1573" => "Lucasdmnasc#1573",
      "lunaloveee#1415" => "lunaloveee#1415",
      "LzJohn#4453" => "LzJohn#4453",
      "M1racle#51146" => "M1racle#11407",
      "majsssster#2148" => "majsssster#2148",
      "MAMAE#11804" => "MAMAE#11804",
      "Matteo#2481" => "Matteo#2481",
      "Maverick#2233" => "Maverick#2233",
      "McBanterFace#1422" => "McBanterFace#1422",
      "Meati#2841" => "Meati#2841",
      "MefiG#1652" => "MefiG#1652",
      "MegaGliscor#1122" => "MegaGliscor#1122",
      "MeninoZAP#1976" => "MeninoZAP#1976",
      "MERO#31635" => "MERO#31635",
      "Mick#11630" => "Mick#11630",
      "Micle#21342" => "Micle#21342",
      "MiGoTop#2343" => "MiGoTop#1600",
      "mikolop#2935" => "mikolop#2935",
      "min#12763" => "min#12763",
      "mishail#21503" => "mishail#21503",
      "moimeme07#2692" => "moimeme07#2692",
      "MokraniChile#1591" => "MokraniChile#1591",
      "Monsanto#1657" => "Monsanto#1657",
      "Moriarty#21434" => "Moriarty#21434",
      "muzzy#1105" => "muzzy#1105",
      "NAGON#1609" => "NAGON#1609",
      "Nails#11791" => "Nails#11791",
      "Nalguidan#1733" => "Nalguidan#1733",
      "Nightcore#2272" => "Nightcore#2272",
      "NikolajHoej#2687" => "NikolajHoej#2687",
      "NikosFas#2624" => "NikosFas#2624",
      "Nineeyebrows#1739" => "Nineeyebrows#1739",
      "Noflame#2377" => "Noflame#2377",
      "NoHandsGamer#1424" => "NoHandsGamer#1424",
      "noise84mond#1315" => "noise84mond#1315",
      "notcreater#1673" => "notcreater#1673",
      "ohtani3#1151" => "ohtani3#1151",
      "okasinnsuke#1294" => "okasinnsuke#1294",
      "OldBoy#2304" => "OldBoy#2304",
      "OmegaZero#5555" => "OmegaZero#5555",
      "Orange#23456" => "Orange#23456",
      "ostinato#31524" => "ostinato#31524",
      "Otsuna#2888" => "Otsuna#2888",
      "Ow3rFoggia#2464" => "Ow3rFoggia#2464",
      "Pain#21382" => "Pain#21382",
      "palenri#1307" => "palenri#1307",
      "Paljuha#2621" => "Paljuha#2621",
      "panas1998#2967" => "panas1998#2967",
      "Paperninja#1648" => "Paperninja#1648",
      "Paradox#2914" => "Paradox#2914",
      "Pardub#21316" => "Pardub#21316",
      "Pascoa#1933" => "Pascoa#1933",
      "Patrick07#1516" => "Patrick07#1516",
      "petrovic#2729" => "petrovic#2729",
      "Phai#11410" => "Phai#11410",
      "pilou#2926" => "pilou#2926",
      "Player671#2257" => "Player671#2257",
      "PocketTrain#2645" => "PocketTrain#2645",
      "posesi#1277" => "posesi#1277",
      "PrestX#1493" => "PrestX#1493",
      "PrinceRedneX#2716" => "PrinceRedneX#2716",
      "PRTHNCA#2873" => "PRTHNCA#2873",
      "Pun#12767" => "Pun#12767",
      "Quirino2ON#1201" => "Quirino2ON#1201",
      "RaFaEl#31138" => "RaFaEl#31138",
      "Rain#25814" => "Rain#25814",
      "RaitO#1559" => "RaitO#1559",
      "Rami94#1340" => "Rami94#1340",
      "Rampengu#11330" => "Rampengu#11330",
      "Ramses#22111" => "Ramses#22111",
      "Rase#1355" => "Rase#1355",
      "RastaFish#2794" => "RastaFish#2794",
      "RazieL#21329" => "RazieL#21329",
      "Rdu#2340" => "Rdu#2340",
      "redyoshi#2461" => "redyoshi#2461",
      "Reliquary#2115" => "Reliquary#2115",
      "reqvam#2191" => "reqvam#2191",
      "Rise#2807" => "Rise#2807",
      "RNGKylin#5449" => "RNGKylin#1963",
      # for some reason there were two, this one wasn't in the sheet
      "RNGLeaoh#1137" => "RNGLeaoh#1523",
      "RNGLeaoh#5779" => "RNGLeaoh#1523",
      "RNGLys#5928" => "RNGLys#1416",
      "RonMexico#11686" => "RonMexico#11686",
      "Ruby#12922" => "Ruby#12922",
      "Rusinho#11447" => "Rusinho#11447",
      "Ryuga#12942" => "Ryuga#12942",
      "Ryvius#31485" => "Ryvius#31485",
      "Saddler#2717" => "Saddler#2717",
      "sailio#21403" => "sailio#21403",
      "Sattors#2968" => "Sattors#2968",
      "SaucisseSwan#2714" => "SaucisseSwan#2714",
      "Seiko#2721" => "Seiko#2721",
      "sensei6#2330" => "sensei6#2330",
      "Sergiy#2111" => "Sergiy#2111",
      "Seulsiho#31505" => "Seulsiho#31505",
      "Shaxy#4385" => "Shaxy#4385",
      "Sidi#2634" => "Sidi#2634",
      "Silvors#21299" => "Silvors#21299",
      "sinah#31954" => "sinah#31954",
      "Sindo#21453" => "Sindo#21453",
      "Skittles#22986" => "Skittles#22986",
      "skliks#21231" => "skliks#21231",
      "Skyreks#2561" => "Skyreks#2561",
      "Sloug#2805" => "Sloug#2805",
      "SNBrox#5201" => "SNBrox#1588",
      "SNCx#5289" => "SNCx#1290",
      "SNJing#5957" => "SNJing#1187",
      "SoleniumSol#2279" => "SoleniumSol#2279",
      "SpinaLogaMan#2388" => "SpinaLogaMan#2388",
      "stathisv13#2578" => "stathisv13#2578",
      "Staz#6447" => "Staz#6447",
      "Stinzy#1610" => "Stinzy#1610",
      "StrikeReaper#2420" => "StrikeReaper#2420",
      "SuperFake#2167" => "SuperFake#2167",
      "Swaggermeist#2310" => "Swaggermeist#2310",
      "Swidz#2563" => "Swidz#2563",
      "syoutotolo#1138" => "syoutotolo#1138",
      "Taesang#3307" => "Taesang#3307",
      "Tansoku#1289" => "Tansoku#1289",
      "Tereuzeraa#1495" => "Tereuzeraa#1495",
      "TheBriefcase#1992" => "TheBriefcase#1992",
      "TheTeacher#21416" => "TheTeacher#21416",
      "tholwmenos#2623" => "tholwmenos#1965",
      "Thund3r#2636" => "Thund3r#2636",
      "ThunderUP#2264" => "ThunderUP#2264",
      "Tincho#1287" => "Tincho#1287",
      "TIZS#3227" => "TIZS#3227",
      "Tobyka#4228" => "Tobyka#4228",
      "tom60229#3684" => "tom60229#3684",
      "totosh#2527" => "totosh#2527",
      "trahison#11389" => "trahison#11389",
      "Tredsred#1762" => "Tredsred#1762",
      "TrueBee#2514" => "TrueBee#2514",
      "Turkishx#2864" => "Turkishx#2864",
      "UchihaSaske#11453" => "UchihaSaske#11453",
      "UnholyMurloc#1827" => "UnholyMurloc#1827",
      "Universe#11899" => "Universe#11899",
      "vadim007#21404" => "vadim007#21404",
      "Valdaboy#2809" => "Valdaboy#2809",
      "Vardu#2836" => "Vardu#2836",
      "VickeBlanka#1576" => "VickeBlanka#1576",
      "Villain#1999" => "Villain#1999",
      "Viper#23812" => "Viper#23812",
      "VirtuozZ#2462" => "VirtuozZ#2462",
      "VKDiana#5809" => "VKDiana#1296",
      "VKmsbc#5573" => "VKmsbc#1831",
      "VKxhx#5910" => "VKxhx#1653",
      "Vrestrita#1990" => "Vrestrita#1990",
      "WaningMoon#1397" => "WaningMoon#1397",
      "Warma#2764" => "Warma#2764",
      "wcysai#5763" => "wcysai#1378",
      "WetGoose#11793" => "WetGoose#11793",
      "WEYouLove#51313" => "WEYouLove#1524",
      "Whiterun#21522" => "Whiterun#21522",
      "wiRer#2160" => "wiRer#2160",
      "Wolder#21746" => "Wolder#21746",
      "Wraziel#2506" => "Wraziel#2506",
      "xBlyzes#2682" => "xBlyzes#2682",
      "XiaoDai#3807" => "XiaoDai#3807",
      "y0ungchrisT#2130" => "y0ungchrisT#2130",
      "Zananananan#2601" => "Zananananan#2601",
      "Zeh#1472" => "Zeh#1472",
      "Zhym#2678" => "Zhym#2678",
      "zlsjs#1181" => "zlsjs#1181",
      "Zoltan#2312" => "Zoltan#2312",
      "Zorb#11411" => "Zorb#11411",
      "Zyrios#2229" => "Zyrios#2229",
      "ПашаТехник#21709" => "ПашаТехник#21709",
      "김수한무#31276" => "김수한무#31276",
      "달라라면#3904" => "달라라면#3904",
      "동기링#3332" => "동기링#3332",
      "레몬박하#31524" => "레몬박하#31524",
      "무에서유창조#3999" => "무에서유창조#3999",
      "살아있는양심#3558" => "살아있는양심#3558",
      "슬퍼하지마노노노#3842" => "슬퍼하지마노노노#3842",
      "애대박#3806" => "애대박#3806",
      "이스티#31432" => "이스티#31432",
      "조치#3550" => "조치#3550",
      "튀긴새우#31703" => "튀긴새우#31703",
      "현명한로나#3498" => "현명한로나#3498",
      "あれっくす#1199" => "あれっくす#1199",
      "ちゃんばら#1831" => "ちゃんばら#1831",
      "てっぺ#1620" => "てっぺ#1620",
      "マイマイ#1495" => "マイマイ#1495",
      "一生所爱丶小梦佳#5511" => "Xiaomengjia#1107",
      "不忘初心丶九千羽#5583" => "jiuqianyu#1921",
      "不忘初心丶天命#5915" => "Tianming#11363",
      "不忘初心丶她#5468" => "LF.Bleau#1968",
      "不忘初心丶小惕#5941" => "XiaoT#11283",
      "不忘初心丶石头记#5215" => "WE.Stone#1864",
      "不忘初心丶麻辣烫#5665" => "DarrenF#11770",
      "不要自闭#5404" => "不要自闭#1919",
      "与我无关#51334" => "NoMB#11352",
      "为何介么叼#51904" => "SN.Rugal#1181",
      "于是乎#51332" => "WolfWarriors2#1418",
      "佳静#51635" => "Cyberostrich#1709",
      "儒雅随和丨小菜泫#5895" => "Rysh.HyunGod#1749",
      "儒雅随和丨橙诺#5263" => "Promise#12519",
      "則龍之王#3989" => "則龍之王#3989",
      "我觉得你有点严格#5660" => "paopao#11183",
      "撒旦降臨#3251" => "撒旦降臨#3251",
      "斗鱼丶古明地觉#5409" => "Satori#11136",
      "殺神2021#5140" => "LP.Xhope#1539",
      "水墨烬千年#51662" => "ShuiMoo#1144",
      "琛哥#51830" => "cgg#11376",
      "疏星丨往昔#5185" => "BiliCook#1133",
      "簡簡#4749" => "簡簡#1877",
      "紅蓮聖天八極式#1668" => "紅蓮聖天八極式#1154",
      "羊飼い#11472" => "羊飼い#11472",
      "聖水洋洋#4496" => "聖水洋洋#4496",
      "虎牙丶元素#5687" => "WE.Yuansu#1433",
      "虎牙丶季岁#5824" => "Youth#11322",
      "虎牙丶幻觉#5279" => "illusion#12400",
      "虎牙丶特兰克斯#5907" => "LP.Trunks#1474",
      "西陵珩#3799" => "西陵珩#3799",
      "銀風#4626" => "銀風#4626",
      "雷霸霸#51352" => "LBB#11681",
      "青鸾丨斗鱼狐英俊#5977" => "foooox#11576",
      "马皇#51594" => "Melody#13117",
      "鹿与谜#5506" => "Seekxmj#1338",
      "麻煩#3368" => "麻煩#336"
    }
  end
end
